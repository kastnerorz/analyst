<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <!-- import CSS -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css"> <!-- #409EFF -->
    <title>类别</title>
</head>
<body>
<div id="app">
    <el-container>
        <el-header style="border-bottom: #409EFF">
            <el-row type="flex" justify="center">
                <el-col :span="12">
                    <el-row :gutter="20">
                        <el-col :span="4">
                            <span style="color:#409EFF;font-size: 30px;height: 40px;">智购</span>
                        </el-col>
                        <el-col :span="10">
                            <el-input prefix-icon="el-icon-search" placeholder="请输入内容" v-model="keyword" @keyup.native.enter="search" clearable></el-input>
                        </el-col>
                        <el-col :span="2" :offset="6">
                            <el-button type="text">清单</el-button>
                        </el-col>
                        <el-col :span="2">
                            <el-button type="text">排行</el-button>
                        </el-col>
                    </el-row>
                </el-col>
            </el-row>
        </el-header>
        <el-main>
            <el-row type="flex">

                <el-col :span="12" :offset="4">
                    <div style="padding:0 20px 20px 0">
                        <el-button type="primary" class="button" @click="report">生成{{ keyword }}类别报告</el-button>
                    </div>
                    <!-- main content -->
                    <el-row type="flex" style="flex-direction: row; flex-wrap: wrap" :gutter="5">
                        <el-col :span="8" :key="item" v-for="(item, index) in items">
                            <el-card :body-style="{ padding: '0px' }" justify="center" style="margin-bottom: 20px;">
                                <div style="text-align: center;">
                                    <img :src="'https://img11.360buyimg.com/n1/s450x450_' + item.imageList.split(',')[0]" class="image" width="150px">
                                </div>
                                <div style="padding: 14px;">
                                    <p style="font-weight: bold">{{ item.zhName }}</p>
                                    <p>颜色：<span style="color:#999">{{ item.color }}</span></p>
                                    <p>评论数：<span style="color:#c73420">{{ item.commentCountStr }}</span><span v-if="item.commentCountStr === null" style="color:#666">暂时没找到</span></p>
                                    <div class="bottom clearfix">
                                        <el-button type="text" class="button" @click="singleAnalyst(item.skuId)">查看分析</el-button>
                                    </div>
                                </div>
                            </el-card>
                        </el-col>
                    </el-row>
                    <!-- basic info card -->

                    <!-- end main content -->
                </el-col>
                <el-col :span="7" :offset="1">

                    <el-card>
                        <div slot="header">
                            <span>需求清单</span>
                        </div>
                        <div>
                            <!--<el-row type="flex" style="flex-direction: row; flex-wrap: wrap;">-->
                            <!--<el-tag v-for="tag in fulfilledTags"-->
                            <!--:key="tag.name"-->
                            <!--closable-->
                            <!--:type="success"></el-tag>-->
                            <!--</el-row>-->
                            <!--<el-row type="flex"-->
                            <!--justify="space-around"-->
                            <!--v-for="tag in unfulfilledTags"-->
                            <!--:key="tag.name"></el-row>-->
                            <el-collapse v-model="activeDemandBlock">
                                <el-collapse-item v-for="demand in demands">
                                    <div slot="title">
                                        {{demand.name}}：
                                        <el-tag v-for="tag in demand.tags"
                                                :key="tag.name"
                                                closable></el-tag>
                                    </div>
                                </el-collapse-item>
                            </el-collapse>
                        </div>
                    </el-card>
                </el-col>
            </el-row>
        </el-main>
        <el-footer>

        </el-footer>
    </el-container>
</div>
</body>
<!-- import axios -->
<script src="https://unpkg.com/axios/dist/axios.js"></script>
<!-- import Vue before Element -->
<script src="https://unpkg.com/vue/dist/vue.js"></script>
<!-- import JavaScript -->
<script src="https://unpkg.com/element-ui/lib/index.js"></script>

<script th:inline="javascript">
    let categoryId = [[${categoryId}]]
    let app = new Vue({
        el: '#app',
        data() {
            return {
                keyword: [[${keyword}]],
                items: []
            }
        },
        created () {
            this.getItems()
        },
        computed: {
        },
        methods: {
            search () {
                if(app.keyword != null){
                    window.location.href = 'search?keyword=' + app.keyword;
                }
            },
            report () {
                window.location.href = 'report?keyword=' + app.keyword;
            },
            getItems () {
                axios({
                    url: '/getItemListByCategoryId',
                    method: 'POST',
                    params: {
                        categoryId: categoryId
                    }
                })
                    .then(res => {
                        this.items = res.data.data
                        console.log(this.items)
                    })
                    .catch(err => {
                        this.$message.error(err)
                    })
            },
            singleAnalyst (skuId) {
                window.location.href = 'http://localhost:8082/search?keyword=https://item.jd.com/' + skuId +'.html';
            }
        }
    });

</script>
</html>